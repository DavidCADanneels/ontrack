<ot-view>

    <div class="row" ng-hide="ontrackGitIssueInfo">
        <div class="col-md-12 alert alert-warning">
            The issue information is loading. This may take some time...
        </div>
    </div>

    <div class="row" ng-if="ontrackGitIssueInfo">
        <div class="col-md-12">

            <div class="panel panel-info">
                <div class="panel-heading">
                    <a href="{{ontrackGitIssueInfo.issue.url}}">
                        {{ontrackGitIssueInfo.issue.displayKey}}
                    </a>
                    -
                    {{ontrackGitIssueInfo.issue.summary}}
                </div>
                <div class="panel-body">
                    <ot-include value="ontrackGitIssueInfo.issue"
                                template="app/extension/{{ontrackGitIssueInfo.issueServiceConfigurationRepresentation.serviceId}}/issue.tpl.html">
                    </ot-include>
                </div>
            </div>

            <!-- For each commit -->
            <div class="row" ng-repeat="issueCommitInfo in ontrackGitIssueInfo.commitInfos">
                <div class="col-md-12">

                    <!-- Summary for the commit -->
                    <ot-extension-git-commit-summary ui-commit="issueCommitInfo.uiCommit" title="true">

                        <table class="table table-condensed table-hover">
                            <tbody ng-repeat="branchInfo in issueCommitInfo.branchInfos">
                                <tr class="info">
                                    <td colspan="2">
                                        Project
                                        <a href="#/project/{{branchInfo.branch.project.id}}">{{branchInfo.branch.project.name}}</a>
                                        Branch
                                        <a href="#/branch/{{branchInfo.branch.id}}">{{branchInfo.branch.name}}</a>
                                    </td>
                                </tr>
                                <!-- No build -->
                                <tr ng-if="!branchInfo.buildView">
                                    <td colspan="2" class="ot-description">
                                        Not included in any build
                                    </td>
                                </tr>
                                <!-- Build -->
                                <tr ng-if="branchInfo.buildView">
                                    <td>
                                        First build
                                    </td>
                                    <td>
                                        <a href="#/build/{{branchInfo.buildView.build.id}}">{{branchInfo.buildView.build.name}}</a>
                                    </td>
                                </tr>
                                <!-- Validation stamps -->
                                <tr ng-if="branchInfo.buildView">
                                    <td>
                                        Validation stamps
                                    </td>
                                    <td>
                                        <span ng-repeat="validationStampRunView in branchInfo.buildView.validationStampRunViews"
                                              class="ot-extension-scm-validationStampRunView">
                                            <ot-validation-stamp-run-view
                                                    validation-stamp-run-view="validationStampRunView"></ot-validation-stamp-run-view>
                                        </span>
                                    </td>
                                </tr>
                                <!-- Promotions -->
                                <tr ng-repeat="promotionView in branchInfo.branchStatusView.promotions">
                                    <td>
                                        <a href="#/promotionLevel/{{promotionView.promotionLevel.id}}">
                                            <ot-entity-image entity="promotionView.promotionLevel"></ot-entity-image>
                                            {{promotionView.promotionLevel.name}}
                                        </a>
                                    </td>
                                    <td>
                                        <span class="ot-description" ng-if="!promotionView.promotionRun">
                                            The revision was never promoted to this promotion level.
                                        </span>
                                        <span ng-if="promotionView.promotionRun">
                                            <span class="fa fa-arrow-right"></span>
                                            <a href="#/build/{{promotionView.promotionRun.build.id}}">
                                                {{promotionView.promotionRun.build.name}}
                                            </a>
                                            <ot-signature value="promotionView.promotionRun.signature"></ot-signature>
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                    </ot-extension-git-commit-summary>

                </div>
            </div>

        </div>
    </div>

</ot-view>