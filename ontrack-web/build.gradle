// TODO Dev & watch
// TODO Version replacement for prod

task npmInstall(type: Exec) {
    commandLine 'npm', 'install'
}

task bowerInstall(type: Exec) {
    commandLine 'bower', 'install', '--force-latest'
}

task setup(dependsOn: ['npmInstall', 'bowerInstall'])

task gruntClean(type: Exec, dependsOn: ['setup']) {
    commandLine 'grunt', 'clean'
}

task versionClean(type: Exec) {
    commandLine 'git', 'checkout', '--', 'package.json'
}

task clean(dependsOn: ['gruntClean', 'versionClean']) {
}

task release(dependsOn: ['setup', 'gruntProd']) {
    ext {
        output = "${project.buildDir}/grunt/prod"
    }
}

task build(dependsOn: ['setup', 'gruntDev'])

task gruntProd(type: Exec) {
    commandLine 'grunt', 'prod'
}

task gruntDev(type: Exec) {
    commandLine 'grunt', 'dev'
}

clean.mustRunAfter setup
gruntDev.mustRunAfter setup
gruntProd.mustRunAfter setup
